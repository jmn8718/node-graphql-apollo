{"version":3,"sources":["../../src/utils/index.js"],"names":["EXPIRES_IN","parseInt","process","env","createToken","sign","id","user","_id","username","SECRET","expiresIn","comparePassword","candidatePassword","hash","callback","compare","verifyToken","token","verify"],"mappings":";;;;;;;AAAA;;;;AACA;;;;;;AAEA,IAAMA,aAAaC,SAASC,QAAQC,GAAR,CAAYH,UAArB,EAAiC,EAAjC,KAAwC,IAA3D;;AAEO,IAAMI,oCAAc,SAAdA,WAAc;AAAA,SAAQ,uBAAIC,IAAJ,CACjC;AACEC,QAAIC,KAAKC,GADX,EACgB;AACdC,cAAUF,KAAKE;AAFjB,GADiC,EAKjCP,QAAQC,GAAR,CAAYO,MALqB,EAMjC;AACEC,eAAWX;AADb,GANiC,CAAR;AAAA,CAApB;;AAWA,IAAMY,4CAAkB,SAAlBA,eAAkB,CAACC,iBAAD,EAAoBC,IAApB,EAA0BC,QAA1B,EAAuC;AACpE,qBAAOC,OAAP,CAAeH,iBAAf,EAAkCC,IAAlC,EAAwCC,QAAxC;AACD,CAFM;;AAIA,IAAME,oCAAc,SAAdA,WAAc,CAACC,KAAD,EAAQH,QAAR,EAAqB;AAC9C,yBAAII,MAAJ,CAAWD,KAAX,EAAkBhB,QAAQC,GAAR,CAAYO,MAA9B,EAAsCK,QAAtC;AACD,CAFM","file":"index.js","sourcesContent":["import jwt from 'jsonwebtoken';\nimport bcrypt from 'bcryptjs';\n\nconst EXPIRES_IN = parseInt(process.env.EXPIRES_IN, 10) || 3600;\n\nexport const createToken = user => jwt.sign(\n  {\n    id: user._id, // eslint-disable-line no-underscore-dangle\n    username: user.username,\n  },\n  process.env.SECRET,\n  {\n    expiresIn: EXPIRES_IN,\n  },\n);\n\nexport const comparePassword = (candidatePassword, hash, callback) => {\n  bcrypt.compare(candidatePassword, hash, callback);\n};\n\nexport const verifyToken = (token, callback) => {\n  jwt.verify(token, process.env.SECRET, callback);\n};\n"]}